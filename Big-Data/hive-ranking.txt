/* Create a table for running a rank function */
create table rank_test ( name string, score int ) row format delimited fields terminated by ',' lines termanted by '\n' stored as textfile;

/* load data into a table */
load data local inpath '/home/cloudera/Desktop/shared/week5_datasets/rank_dataset.csv'
into table rank_test;

/* run a rank function */
select name, score, rank() over(order by score desc) as ranking from rank_test;

/* Dense rank example */
select name, score, dense_rank() over( order by score desc ) as ranking from rank_test;

/* Row number example */
select name, score, row_number() over( order by score desc ) as ranking from rank_test;

/* Row number with partition by clause */
select name, score, row_number() over ( partition by name order by score desc )
as ranking from rank_test;
